{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true,
    "pycharm": {
     "name": "#%% md\n"
    }
   },
   "source": [
    "# Ch2-Lecture 5\n",
    "\n",
    "## No cloning theorem\n",
    "\n",
    "One of the most natural operations we perform daily on classical computers is the act of copying or _cloning_ classical bits. For example, you might make a copy of a file containing your -typed homework to keep as a backup. On the negative side, a criminal might copy a classical object like a banknote (though it is not easy) to use as forged money. However, in quantum it turns out that copying quantum bits is impossible — given an arbitrary, unknown quantum state $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C} ^2$ , there is no quantum circuit which creates a perfect copy of  $\\left|\\psi\\right\\rangle$ ! How can we formalize such a statement?\n",
    "\n",
    "\n",
    "We use proof by contradiction. Suppose there exists a unitary $U\\in \\mathcal L\\left(\\mathbb C^2 \\otimes \\mathbb C^2 \\right)$ which, for any $ \\left|\\psi\\right\\rangle $, maps $ \\left|\\psi\\right\\rangle  \\otimes  \\left|0\\right\\rangle $ to $ \\left|\\psi\\right\\rangle  \\otimes  \\left|\\psi\\right\\rangle $, i.e. creates a copy of $ \\left|\\psi\\right\\rangle $. To obtain the desired contradiction, we begin by applying $U$ to two arbitrary states $ \\left|\\psi_1\\right\\rangle , \\left|\\psi_2\\right\\rangle  \\in  \\mathbb{C} ^2$ , obtaining\n",
    "$$\n",
    " \\left|\\phi\\right\\rangle =U \\left( \\left|\\psi_1\\right\\rangle  \\otimes  \\left|0\\right\\rangle \\right)= \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_1\\right\\rangle\n",
    "$$\n",
    "and\n",
    "$$\n",
    " \\left|\\phi^\\prime \\right\\rangle =U \\left( \\left|\\psi_2\\right\\rangle  \\otimes  \\left|0\\right\\rangle \\right)= \\left|\\psi_2\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle\n",
    "$$\n",
    "What happens if we now take the inner product $ \\left\\langle \\phi \\middle| \\phi^\\prime  \\right\\rangle $? The middle terms of these equations yield\n",
    "$$\n",
    " \\left( \\left\\langle \\psi_1 \\right|  \\otimes  \\left\\langle 0 \\right| \\right)U^\\dagger U \\left( \\left|\\psi_2\\right\\rangle  \\otimes  \\left|0\\right\\rangle \\right) = \\left( \\left\\langle \\psi_1 \\right|  \\otimes  \\left\\langle 0 \\right| \\right) \\left( \\left|\\psi_2\\right\\rangle  \\otimes  \\left|0\\right\\rangle \\right)  =  \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle \\left\\langle 0 \\middle| 0 \\right\\rangle = \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle\n",
    "$$\n",
    "On the other hand, the right sides of the equations yield\n",
    "$$\n",
    " \\left( \\left\\langle \\psi_1 \\right|  \\otimes  \\left\\langle \\psi_1 \\right| \\right) \\left( \\left|\\psi_2\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle \\right)= \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle  \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle =  \\left( \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle \\right)^2\n",
    "$$\n",
    "\n",
    "Combining these two, we have that $ \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle =  \\left( \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle \\right)^2 $ for some complex number $ \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle  \\in  \\mathbb{C} $. This is equivalent to saying $c = c^2$ for $c \\in  \\mathbb{C} $, which has only two solutions — either $c = 1$ or $c = 0$. In other words, unless  $\\left|\\psi_1\\right\\rangle$  i and $ \\left|\\psi_2\\right\\rangle $ are the same vector (in which case $ \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle  = 1$) or are orthogonal (i.e. $ \\left\\langle \\psi_1 \\middle| \\psi_2 \\right\\rangle  = 0$), we have a contradiction. Thus, there does not exist a $U$ which can perform the mapping $ \\left|\\psi\\right\\rangle  \\otimes  \\left|0\\right\\rangle  \\mapsto  \\left|\\psi\\right\\rangle  \\otimes  \\left|\\psi\\right\\rangle $ for arbitrary $ \\left|\\psi\\right\\rangle $."
   ]
  },
  {
   "cell_type": "markdown",
   "source": [
    "#### Send it after class 1\n",
    "\n",
    "This section showed that cloning arbitrary states $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C} ^2 $ is impossible. However, the proof technique failed when the states $ \\left|\\psi_1\\right\\rangle $ and $ \\left|\\psi_2\\right\\rangle $ are orthogonal. Indeed, it turns out in this case cloning is possible. Give a quantum circuit which can clone states $ \\left|0\\right\\rangle $ and $ \\left|1\\right\\rangle$, i.e. maps $ \\left|0\\right\\rangle  \\left|0\\right\\rangle  \\mapsto  \\left|0\\right\\rangle  \\left|0\\right\\rangle $ and $ \\left|1\\right\\rangle  \\left|0\\right\\rangle  \\mapsto  \\left|1\\right\\rangle  \\left|1\\right\\rangle $. How about a circuit which clones $ \\left|+\\right\\rangle $ and $ \\left|-\\right\\rangle $? (Hint: Convert the $+/−$ basis into the standard basis first, then apply your cloning circuit for the standard basis.)"
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "## Quantum entanglement\n",
    "\n",
    "We have already seen the concept of quantum entanglement, and in particular used Bell states such as $ \\left|\\Phi^+\\right\\rangle =  \\frac{1}{\\sqrt{2}}  \\left(\\left|00\\right\\rangle+\\left|11\\right\\rangle\\right)$ as a _resource_ for performing interesting tasks such as quantum teleportation. But what exactly _is_ entanglement, and how can we recognize whether a given state $ \\left|\\psi\\right\\rangle $ is entangled?\n",
    "\n",
    "**History**. The term “entanglement” was coined in 1935 by physicist Erwin Schrödinger, who used the term “Vershränkung”, which in colloquial “non-physicist” German means “folding of the arms”. As discussed in a previous lecture, the question of whether entanglement truly exists has been a subject of intense debate. The famous Einstein-Podolsky-Rosen paper of 1935, in particular, argued that quantum mechanics could not be a complete physical theory due to its prediction of entangled states such as |Φ+ i. In 1964, however, physicist John Bell proposed what is now known as a “Bell inequality” or “Bell test”; this test could in principle be run in a lab to confirm whether Nature indeed allows the strong type of correlations between qubits which entanglement would allow. Recently, such tests have been studied under the guise of “non-local games”, which is a topic we shall soon visit. Moreover, it is important to note that we nowadays know that any quantum computation (on pure quantum states) cannot achieve an exponential speedup over classical computers unless the amount of quantum entanglement in the system is “large”. Thus, entanglement is generally regarded as an important resource.\n",
    "\n",
    "\n",
    "### Bipartite entanglement\n",
    "In this lecture, we study the notion of bipartite entanglement, meaning entanglement between a pair of quantum systems. Let $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C}^{d_1} \\otimes \\mathbb{C}^{d_2}$ be an arbitrary bipartite state. How can we tell if $ \\left|\\psi\\right\\rangle $ is entangled? Strictly speaking, earlier we defined $ \\left|\\psi\\right\\rangle $ as _entangled_ if it cannot be written as the tensor product of two states $ \\left|\\psi_1\\right\\rangle \\in  \\mathbb{C} ^{d_1} $ and $ \\left|\\psi_2\\right\\rangle \\in  \\mathbb{C} ^{d_2} $ , i.e.\n",
    "\n",
    "$$\n",
    "\\forall \\left|\\psi_1\\right\\rangle \\in  \\mathbb{C} ^{d_1},\\left|\\psi_2\\right\\rangle \\in  \\mathbb{C} ^{d_2}\n",
    "$$\n",
    "we have\n",
    "$$\n",
    " \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle \\neq  \\left|\\psi\\right\\rangle\n",
    "$$\n",
    "\n",
    "For example, let us confirm that $ \\left|\\Phi^+\\right\\rangle = \\frac{1}{\\sqrt{2}}  \\left( \\left|00\\right\\rangle + \\left|11\\right\\rangle \\right) $ is entangled. Again, we give a proof\n",
    "by contradiction. Suppose there exist $ \\left|\\psi_1\\right\\rangle \\in  \\mathbb{C}^2 $ , $ \\left|\\psi_2\\right\\rangle  \\in  \\mathbb{C} ^2$ such that $ \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle = \\left|\\Phi^+\\right\\rangle $. If we write $ \\left|\\psi_1\\right\\rangle = \\alpha_1  \\left|0\\right\\rangle + \\beta_1  \\left|1\\right\\rangle $ and $ \\left|\\psi_2\\right\\rangle = \\alpha_2  \\left|0\\right\\rangle + \\beta_2  \\left|1\\right\\rangle $, we have\n",
    "\n",
    "$$\n",
    " \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle= \\left(\\alpha_1  \\left|0\\right\\rangle + \\beta_1  \\left|1\\right\\rangle\\right) \\otimes  \\left(\\alpha_2  \\left|0\\right\\rangle + \\beta_2  \\left|1\\right\\rangle\\right)= \\alpha_1  \\alpha_2  \\left|00\\right\\rangle +  \\alpha_1  \\beta_2  \\left|01\\right\\rangle +  \\beta_1  \\alpha_2  \\left|10\\right\\rangle+ \\beta_1  \\beta_2  \\left|11\\right\\rangle\n",
    "$$\n",
    "\n",
    "Since this supposed to equal $ \\left|\\Phi^+\\right\\rangle = \\frac{1}{\\sqrt{2}}  \\left( \\left|00\\right\\rangle + \\left|11\\right\\rangle \\right) $, we must have $ \\alpha_1  \\beta_2 =  \\beta_1  \\alpha_2  =0$ (since the standard basis vectors $ \\left|00\\right\\rangle ,  \\left|01\\right\\rangle , \\left|10\\right\\rangle ,  \\left|11\\right\\rangle $ are orthogonal). Suppose, without loss of generality, that $ \\beta_2 =0$, so that $= \\alpha_1  \\beta_2 = 0$. Then, we must also have $ \\beta_1=0$ so that $ \\beta_1  \\alpha_2 =0$ (the other option is to set $ \\alpha_2= 0$, but this would yield $ \\alpha_2 = \\beta_2  = 0$, i.e. $ \\left|\\psi_2\\right\\rangle $ is not a unit vector). But if $ \\beta_1 = \\beta_2  = 0$, then $ \\left|\\psi_1\\right\\rangle= \\left|0\\right\\rangle  $ and $ \\left|\\psi_2\\right\\rangle = \\left|0\\right\\rangle $, so that $ \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle = \\left|00\\right\\rangle \\neq \\left|\\Phi^+\\right\\rangle $! Thus, we have a contradiction, and so $ \\left|\\Phi^+\\right\\rangle $ is entangled\n",
    "\n",
    "### The Schmidt decomposition.\n",
    "\n",
    "Rather than go through such proofs each time we wish to check if $ \\left|\\psi\\right\\rangle $ is entangled, there is a more elegant tool we can use known as the _Schmidt decomposition_. To keep our discussion simple, we shall restrict our attention to the setting of two qubits; the ideas here extend straightforwardly to arbitrary local dimensions $d_1$ and $d_2$ . The Schmidt decomposition states that any vector $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C}^2 \\otimes  \\mathbb{C}^2$ can be written in the following special form:\n",
    "\n",
    "$$\n",
    " \\left|\\psi\\right\\rangle = \\alpha_0 \\left|a_0\\right\\rangle \\left|b_0\\right\\rangle+ \\alpha_1\\left|a_1\\right\\rangle \\left|b_1\\right\\rangle\n",
    "$$\n",
    "\n",
    "where the $ \\alpha_i$ are real and satisfy $ \\alpha_i\\geq 0$, and where $ \\left\\{ \\left|a_i\\right\\rangle \\right\\}^2_{i=1} $ and $ \\left\\{ \\left|b_i\\right\\rangle \\right\\}^2_{i=1} $ are orthonormal bases for $ \\mathbb{C}^2$ . The number of non-zero $ \\alpha_i$ is called the _Schmidt rank_ of $ \\left|\\psi\\right\\rangle $.\n",
    "\n",
    "Observe now that if $ \\left|\\psi\\right\\rangle $ has Schmidt rank 1, then clearly it is not entangled, as its Schmidt decomposition is in tensor product form. And this is no coincidence — it turns out that an arbitrary state $ \\left|\\psi\\right\\rangle $ is entangled if and only if its Schmidt rank is strictly greater than 1.\n",
    "\n",
    "Let us close by pointing out a subtle fact about Schmidt decompositions. Note that any vector $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C}^2 \\otimes  \\mathbb{C}^2$ can be written as\n",
    "\n",
    "$$\n",
    " \\left|\\psi\\right\\rangle = \\alpha_{00} \\left|00\\right\\rangle  +\\alpha_{01} \\left|01\\right\\rangle+\\alpha_{10} \\left|10\\right\\rangle  +\\alpha_{11} \\left|11\\right\\rangle\n",
    "$$\n",
    "This decomposition requires four terms (i.e. one per standard basis vector for $ \\mathbb{C}^4$ ). Part of the power of the Schmidt decomposition is that it manages to write this same state using just two terms."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "### Send it after class 2\n",
    "\n",
    "* Verify that $ \\left|00\\right\\rangle $ and $ \\left|\\Phi^+\\right\\rangle =  \\frac{1}{\\sqrt{2}}  \\left(  \\left|00\\right\\rangle + \\left|11\\right\\rangle  \\right) $ are already written in terms of Schmidt decompositions. What are the Schmidt ranks of these two states?\n",
    "* Use the notion of Schmidt rank to answer the following: Is $ \\left|+\\right\\rangle  \\left|-\\right\\rangle $ entangled? How about $\\sqrt{1/1000} \\left|+\\right\\rangle  \\left|-\\right\\rangle +\\sqrt{999/1000} \\left|-\\right\\rangle  \\left|+\\right\\rangle $? Finally, how about $\\frac{1}{\\sqrt{2}}  \\left(  \\left|0\\right\\rangle \\left|+\\right\\rangle - \\left|0\\right\\rangle   \\left|-\\right\\rangle \\right) $$? (Hint: For this last one, be careful! Is it written in its Schmidt decomposition?)"
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "## Density Matrices\n",
    "\n",
    "We have delved further into the structure of entanglement and learned that a bipartite state $ \\left|\\psi\\right\\rangle $ is entangled if and only if its Schmidt rank is at least 2. However, let’s take a step back and return to our statement that $ \\left|\\psi\\right\\rangle $ is entangled if it cannot be written as $ \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle $ for some $ \\left|\\psi_1\\right\\rangle  \\in  \\mathbb{C}^{d_1}$ and $ \\left|\\psi_2\\right\\rangle  \\in  \\mathbb{C}^{d_2}$ . Intuitively, states of the form $ \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle $, called _tensor product states_, are nice because one can immediately read off the state of each qubit — qubit one is in state $ \\left|\\psi_1\\right\\rangle $ , and qubit two in $ \\left|\\psi_2\\right\\rangle $ i. Since entangled states cannot be written in tensor product form, however, this raises the question: How can we describe the state of qubit one in, say, the Bell pair $ \\left|\\Phi^+\\right\\rangle =  \\frac{1}{\\sqrt{2}}  \\left(  \\left|00\\right\\rangle + \\left|11\\right\\rangle  \\right) $? The answer lies in a more general formalism for describing quantum states, known as the _density matrix formalism._\n",
    "\n",
    "Thus far, we have said that an arbitrary $d$-dimensional quantum state is described by a unit vector $ \\left|\\psi\\right\\rangle $ in $ \\mathbb{C}^d$ . Such states are called _pure_ because we know exactly which state $ \\left|\\psi\\right\\rangle $ we have. Now, suppose we play a game in which with probability 1/2, I give you state $ \\left|\\psi_1\\right\\rangle $, and with probability 1/2, I give you state $ \\left|\\psi_2\\right\\rangle $, and I don’t tell you which state I’ve given you. How can you describe the quantum state in your possession, given that you don’t know whether you actually have $ \\left|\\psi_1\\right\\rangle $ or $ \\left|\\psi_2\\right\\rangle $? This is done via the _density operator_\n",
    "\n",
    "$$\n",
    "  \\rho  = \\frac{1}{2}  \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right| + \\frac{1}{2}  \\left| \\psi_2 \\right\\rangle\\!\\left\\langle \\psi_2 \\right|\n",
    "$$\n",
    "\n",
    "More generally, if we play this game with m possible states  $\\left|\\psi_i\\right\\rangle $, each given with probability $p_i$ (i.e. $ \\sum_{i} p_i =1 $ and $p_i\\geq0$), then the density operator describing your system is\n",
    "\n",
    "$$\n",
    "  \\rho  = \\sum_{i=1}^{m} p_i \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right|\n",
    "$$\n",
    "\n",
    "Such a state is called mixed because you don’t know with certainty which $ \\left|\\psi_i\\right\\rangle $ you have in your possession. Let us make two important observations here.\n",
    "\n",
    "Mixtures vs. superpositions\n",
    ": A mixture of states $ \\sum_{i=1}P_i \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right| $ is entirely different than a superposition of states $ \\sum_{i=1} \\alpha_i  \\left|\\psi_i\\right\\rangle $. For starters, the former is a sum of matrices, whereas the latter is a sum of vectors. More importantly, the former models a state of ignorance about which $ \\left|\\psi_i\\right\\rangle $ we actually have in our possession — we know our system is in _precisely one_ such $ \\left|\\psi_i\\right\\rangle $, but which one is unknown. In stark contrast, in a superposition, our system is in all of the states $ \\left|\\psi_i\\right\\rangle $ simultaneously.\n",
    "\n",
    "Let us stress the above point above with a concrete example. The density matrix $ \\rho = \\frac{1}{2}  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right| + \\frac{1}{2}  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right| $ is:\n",
    "\n",
    "$$\n",
    " \\rho =  \\frac{1}{2}  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right| + \\frac{1}{2}  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right| = \\frac{1}{2}  \\begin{pmatrix} 1 & 0 \\\\  0 & 0  \\end{pmatrix}+\\frac{1}{2}  \\begin{pmatrix} 0 & 0 \\\\  0 & 1  \\end{pmatrix}=  \\begin{pmatrix} \\frac{1}{2} & 0 \\\\  0 & \\frac{1}{2}  \\end{pmatrix}=\\frac{I}{2}\n",
    "$$\n",
    "\n",
    "In contrast, the state vector $  \\left|\\psi\\right\\rangle  = \\frac{1}{\\sqrt{2}}  \\left|0\\right\\rangle + \\frac{1}{\\sqrt{2}}  \\left|1\\right\\rangle $ is given by\n",
    "\n",
    "$$\n",
    " \\left|\\psi\\right\\rangle = \\frac{1}{\\sqrt{2}}  \\left|0\\right\\rangle + \\frac{1}{\\sqrt{2}}  \\left|1\\right\\rangle =  \\frac{1}{\\sqrt{2}}  \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\frac{1}{\\sqrt{2}}  \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}  \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n",
    "$$\n",
    "\n",
    "Note that the former is a matrix, while the latter is a vector, i.e. these are completely different objects!\n",
    "\n",
    "Pure states.\n",
    ": If there is only one state $ \\left|\\psi_i\\right\\rangle $ in the mixture, i.e. $p_i = 1$ for some $i$, then the mixture simply reads $  \\rho   = \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right| $. This state is called pure and has rank 1. Conversely, for any pure state $ \\left|\\psi\\right\\rangle $, its density matrix is the rank 1 operator $  \\rho  = \\left| \\psi \\right\\rangle\\!\\left\\langle \\psi \\right| $.\n",
    "\n",
    "As for the property of being positive semidefinite, we use the following fact: For any two positive semi-definite matrices $A$ and $B$ and real numbers $p,q \\geq 0$, it holds that $pA + qB$ is also positive semi-definite. In particular, since both $ \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right| $ and $ \\left| \\psi_2 \\right\\rangle\\!\\left\\langle \\psi_2 \\right| $ are positive semi-definite, we have that $ \\rho $ is also positive semi-definite. Thus, $ \\rho $ is a valid density operator.\n",
    "\n",
    "In fact, the requirements that $ \\text{Tr}\\left( \\rho \\right) $ and $ \\rho $ be positive semidefinite allow us to recover exactly the interpretation of mixed states which this section started with — taking the spectral decomposition of $ \\rho $, we have\n",
    "\n",
    "$$\n",
    " \\rho = \\sum_{i=1}   \\lambda_i   \\left| \\lambda_i \\right\\rangle\\!\\left\\langle \\lambda_i \\right|\n",
    "$$\n",
    "\n",
    "Since $ \\rho $ is positive semidefinite, we know $  \\lambda_i \\geq 0 $ for all $i$. Moreover, recalling that $  \\text{Tr}\\left( \\rho \\right) =1 $, it holds that $ \\sum_{i=1}  \\lambda_i =1 $. Thus, $ \\left\\{  \\lambda_i \\right\\}_i $ forms a probability distribution. This means that we can interpret $ \\rho $ as follows: With probability $  \\lambda_i $ , prepare state $ \\left|\\lambda_i\\right\\rangle $. This is precisely the idea we started this section with! We thus have a good picture of how one can describe probabilistic mixtures over pure quantum states."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "#### Send it after class 3\n",
    "\n",
    "* Why is $ \\left| \\psi \\right\\rangle\\!\\left\\langle \\psi \\right| $ positive semi-definite for any $ \\left|\\psi\\right\\rangle $? (Hint: Use the spectral decomposition).\n",
    "* Why are the Pauli gates $X$, $Y$ , and $Z$ not density matrices?"
   ],
   "metadata": {
    "collapsed": false,
    "pycharm": {
     "name": "#%% md\n"
    }
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "The maximally mixed state.\n",
    ": Finally, let us consider a very special density matrix in $ \\mathcal{L}  \\left( \\mathbb{C}^d\\right) $, the _maximally mixed_ state $ \\rho=I/d$ (where $I$ denotes the identity matrix). Note that $ \\rho $ is positive semidefinite since $I$ is positive semidefinite (in fact, $I$ has eigenvalues all equal to 1), and $ \\text{Tr}\\left(I/d\\right)  = \\frac{1}{d} \\text{Tr}\\left(I\\right)=1   $. Thus, $ \\rho $ is a valid density operator. But what exactly does $I/d$ represent? Here, we use the fact that for any orthonormal basis $  \\left\\{ \\left|\\psi_i\\right\\rangle \\right\\}_{i=1}^d  $ for $ \\mathbb{C}^d $, we have:\n",
    "\n",
    "$$\n",
    " \\sum_{i=1}^{d} \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right| =I\n",
    "$$\n",
    "\n",
    "In other words, for any orthonormal basis $  \\left\\{ \\left|\\psi_i\\right\\rangle \\right\\}_{i=1}^d  $ , $\\rho$ represents the following state: Pick state $ \\left|\\psi_i\\right\\rangle $ with probability $1/d$, and prepare $ \\left|\\psi_i\\right\\rangle $. Since this holds for any basis, we conclude that $ \\rho $ gives us absolutely no information about which state $ \\left|\\psi\\right\\rangle $ we actually have — every state is an eigenvector of $ \\rho $, and the eigenvalues of $ \\rho $ form a uniform distribution. Thus, the maximally mixed state represents the case where we know nothing about the state of our system! This will be crucial when we discuss entanglement again below."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "### The partial trace operation\n",
    "\n",
    "Our motivation in introducing density matrices stemmed from the fact that we did not know how to describe the state of qubit 1 in the Bell pair $ \\left|\\Phi^+\\right\\rangle =  \\frac{1}{\\sqrt{2}}  \\left(\\right)  \\left|00\\right\\rangle + \\left|11\\right\\rangle $. We claimed that the answer lies in the framework of density matrices, but we have not yet prescribed how one can use density matrices to describe the state of qubit 1 of $ \\left|\\Phi^+\\right\\rangle $. We now do this via the _partial trace_ operation.\n",
    "Intuitively, given a bipartite density matrix $ \\rho_{AB} $ on systems $A$ and $B$, the partial trace operation $ \\text{Tr}_B\\left( \\rho_{AB}\\right) $ returns a density matrix on system $A$ alone (analogously, $ \\text{Tr}_A\\left( \\rho_{AB}\\right) $ returns a density matrix on $B$ alone). Formally, we have that\n",
    "\n",
    "$$\n",
    " \\text{Tr}_B: \\mathcal{L} \\left( \\mathbb{C}^{d_1} \\otimes \\mathbb{C}^{d_2}\\right) \\mapsto  \\mathcal{L}  \\left( \\mathbb{C}^d\\right)\n",
    "$$\n",
    "\n",
    "How exactly is $ \\text{Tr}_B$ defined? Recall that the trace of a matrix $  \\rho   \\in \\mathcal{L} \\left(\\mathbb{C}^d\\right) $ is defined as\n",
    "\n",
    "$$\n",
    " \\text{Tr}\\left( \\rho \\right)= \\sum_{i=1} \\rho  \\left(i,i\\right)= \\sum_{i=1}^{d} \\left\\langle i \\right|  \\rho  \\left|i\\right\\rangle\n",
    "$$\n",
    "\n",
    "For the partial trace, we copy this idea, except we only apply it to one subsystem as follows: For $ \\rho  \\in  \\mathcal{L}  \\left( \\mathbb{C}^{d_1} \\otimes \\mathbb{C}^{d_2}\\right) $,\n",
    "\n",
    "$$\n",
    " \\text{Tr}_B\\left( \\rho \\right)= \\sum_{i=1}^{d_2} \\left(I_A \\otimes  \\left\\langle i \\right| \\right) \\rho  \\left(I_A \\otimes  \\left|i\\right\\rangle \\right)\n",
    "$$\n",
    "\n",
    "In other words, we leave system $A$ untouched (hence the $I_A$ terms above), and “trace out” system $B$. Note that like the trace, the partial trace is a linear map. Let us practice this operation on a number of states, and in the process draw our desired connection to the Bell state which we started this lecture with.\n",
    "\n",
    "_Example 1_: _Product states_. Suppose first that $ \\rho $ is the density matrix of a pure product state $ \\left|\\psi\\right\\rangle =  \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle $ In other words,\n",
    "\n",
    "$$\n",
    "  \\rho = \\left(\\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle\\right)  \\left( \\left\\langle \\psi_1 \\right|  \\otimes  \\left\\langle \\psi_2 \\right| \\right)= \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right|_A \\otimes  \\left| \\psi_2 \\right\\rangle\\!\\left\\langle \\psi_2 \\right|_B\n",
    "$$\n",
    "\n",
    "Recall that earlier we said the state of $ \\left|\\psi\\right\\rangle $ on qubit 1 is exactly $ \\left|\\psi_1\\right\\rangle $ . Let us confirm this by applying the partial trace to $ \\rho $ to trace out subsystem $B$:\n",
    "\n",
    "$$\n",
    "\\begin{align*}\n",
    " \\text{Tr}_B\\left( \\rho \\right) &= \\text{Tr}_B\\left( \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right| \\otimes  \\left| \\psi_2 \\right\\rangle\\!\\left\\langle \\psi_2 \\right| \\right) \\\\\n",
    " &= \\sum_{i=1}^{d} \\left(I \\otimes  \\left\\langle i \\right| \\right) \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right|  \\otimes  \\left| \\psi_2 \\right\\rangle\\!\\left\\langle \\psi_2 \\right|  \\left(I \\otimes  \\left|i\\right\\rangle \\right) \\\\\n",
    " &= \\sum_{i=1}^{d} \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right|  \\otimes    \\left\\langle i \\middle| \\psi_2 \\right\\rangle  \\left\\langle \\psi_2 \\middle| i \\right\\rangle\\\\\n",
    " &=  \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right|  \\text{Tr}\\left( \\left| \\psi_2 \\right\\rangle\\!\\left\\langle \\psi_2 \\right| \\right)\\\\\n",
    " &=  \\left| \\psi_1 \\right\\rangle\\!\\left\\langle \\psi_1 \\right|\n",
    "\\end{align*}\n",
    "$$\n",
    "\n",
    "where the second equality applies the definition of the partial trace, the second-last equality uses the definition of the trace, and the last equality uses the cyclic property of the trace. In other words, the state of qubit 1 is $ \\left|\\psi_1\\right\\rangle $, as claimed! Note that the calculation above did not use the fact that $\\left|\\psi\\right\\rangle =  \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle $ is pure — indeed, the same calculation yields that for any operator $ \\rho  =  \\rho_1  \\otimes  \\rho_2$ ,\n",
    "\n",
    "$$\n",
    " \\text{Tr}_B\\left( \\rho \\right)= \\rho_1. \\text{Tr}\\left( \\rho_2\\right)  .\n",
    "$$\n",
    "\n",
    "_Example 2: Separable states_. We have said that a pure state $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C}^{d_1} \\otimes \\mathbb{C}^{d_1} $ is not entangled, or _separable_, if and only if  $ \\left|\\psi\\right\\rangle =  \\left|\\psi_1\\right\\rangle  \\otimes  \\left|\\psi_2\\right\\rangle $ for some $ \\left|\\psi_1\\right\\rangle  \\in  \\mathbb{C}^{d_1} $ and $ \\left|\\psi_2\\right\\rangle  \\in  \\mathbb{C}^{d_2} $. This idea extends to the setting of mixed states as follows: A bipartite density matrix $ \\rho  \\in  \\mathcal{L}  \\left(\\mathbb{C}^{d_1} \\otimes \\mathbb{C}^{d_2}\\right) $ is unentangled or _separable_ if\n",
    "\n",
    "$$\n",
    " \\rho = \\sum_{i=1}p_i \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right|  \\otimes  \\left| \\phi_i \\right\\rangle\\!\\left\\langle \\phi_i \\right|\n",
    "$$\n",
    "\n",
    "for some (possibly non-orthogonal) sets of vectors $ \\left\\{ \\left|\\psi_i\\right\\rangle \\right \\}\\subseteq  \\mathbb{C}^{d_1} $ and , and where the $ \\left\\{p_i\\right\\} $ form a probability distribution. In other words, $ \\rho $ is a probabilistic mixture of pure product states. An example of a separable state is\n",
    "\n",
    "$$\n",
    " \\rho = \\frac{1}{2}  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right|  \\otimes  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right| + \\frac{1}{2}  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right|  \\otimes  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right|\n",
    "$$\n",
    "\n",
    "Since the partial trace is a linear map, and since we know that $\\text{Tr}_B\\left( \\rho_1 \\otimes  \\rho_2\\right)= \\rho_1. \\text{Tr}\\left( \\rho_2\\right)= \\rho_1$ for density matrices $ \\rho_1$ , $ \\rho_2$ , computing the partial trace of $ \\rho $ for separable states is simple:\n",
    "\n",
    "$$\n",
    "\\begin{align*}\n",
    " \\text{Tr}_B\\left(\\sum_{i=1}p_i \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right|  \\otimes  \\left| \\phi_i \\right\\rangle\\!\\left\\langle \\phi_i \\right|\\right) &=\\sum_{i=1}p_i\\text{Tr}_B\\left( \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right|  \\otimes  \\left| \\phi_i \\right\\rangle\\!\\left\\langle \\phi_i \\right|\\right) \\\\\n",
    " =& \\sum_{i=1}p_i \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right|. \\text{Tr}_B\\left(   \\left| \\phi_i \\right\\rangle\\!\\left\\langle \\phi_i \\right|\\right)\\\\\n",
    " =& \\sum_{i=1}p_i \\left| \\psi_i \\right\\rangle\\!\\left\\langle \\psi_i \\right|\n",
    "\\end{align*}\n",
    "$$\n",
    "\n",
    "Let us make one further comment about mixed separable states. We saw earlier that it is “easy” to check if a bipartite pure state |ψi ∈ Cd ⊗ Cd is entangled by determining its Schmidt rank (we did not explicitly state this, but the Schmidt rank can be calculated in time polynomial in the dimension d). In stark contrast, it turns out that determining whether a mixed state ρ ∈ L(Cd ⊗ Cd ) is separable is NP-hard! This is another strong reminder that the settings of pure versus mixed states are indeed very different; the latter is typically much more difficult to work with.\n",
    "\n",
    "\n",
    "_Example 3: Pure entangled states_. We finally arrive at the case we started this lecture with: Pure entangled states such as $ \\left|\\Phi^+\\right\\rangle $. To compute the partial trace of any pure bipartite $ \\left|\\psi\\right\\rangle  $, one approach is to simply write out $ \\left|\\psi\\right\\rangle $ in the standard basis, take its density matrix $ \\rho = \\left| \\psi \\right\\rangle\\!\\left\\langle \\psi \\right| $, and then compute $ \\text{Tr}_B\\left( \\rho \\right) $. For example, for $ \\left|\\Phi^+\\right\\rangle $, we have\n",
    "\n",
    "$$\n",
    "\\begin{align*}\n",
    " \\text{Tr}_B\\left( \\left| \\Phi^+ \\right\\rangle\\!\\left\\langle \\Phi^+ \\right| \\right) &=  \\frac{1}{2}  \\text{Tr}_B\\left( \\left( \\left|00\\right\\rangle + \\left|11\\right\\rangle \\right) \\left( \\left\\langle 00 \\right| + \\left\\langle 11 \\right| \\right)  \\right)\\\\\n",
    " &= \\frac{1}{2}  \\text{Tr}_B\\left( \\left| 00 \\right\\rangle\\!\\left\\langle 00 \\right|+ \\left| 00 \\right\\rangle\\!\\left\\langle 1\\right|+ \\left| 11 \\right\\rangle\\!\\left\\langle 00 \\right|+ \\left| 11 \\right\\rangle\\!\\left\\langle 11 \\right|    \\right) \\\\\n",
    " &=\\frac{1}{2}  \\text{Tr}_B\\left( \\left| 00 \\right\\rangle\\!\\left\\langle 00 \\right|\\right)+\\frac{1}{2}  \\text{Tr}_B\\left( \\left| 00 \\right\\rangle\\!\\left\\langle 11 \\right|\\right)+\\frac{1}{2}  \\text{Tr}_B\\left( \\left| 11 \\right\\rangle\\!\\left\\langle 00 \\right|\\right)+\\frac{1}{2}  \\text{Tr}_B\\left( \\left| 11 \\right\\rangle\\!\\left\\langle 11 \\right|\\right)\\\\\n",
    " &=\\frac{1}{2}  \\text{Tr}_B\\left(  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right|  \\otimes  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right| \\right)+\\frac{1}{2}  \\text{Tr}_B\\left(  \\left| 0 \\right\\rangle\\!\\left\\langle 1 \\right|  \\otimes  \\left| 0 \\right\\rangle\\!\\left\\langle 1 \\right| \\right) + \\frac{1}{2}  \\text{Tr}_B\\left(  \\left| 1 \\right\\rangle\\!\\left\\langle 0 \\right|  \\otimes  \\left| 1 \\right\\rangle\\!\\left\\langle 0 \\right| \\right) \\\\\n",
    " & +\\frac{1}{2}  \\text{Tr}_B\\left(  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right|  \\otimes  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right| \\right)\\\\\n",
    " &= \\frac{1}{2}  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right|  \\text{Tr}\\left( \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right| \\right)+\\frac{1}{2}  \\left| 0 \\right\\rangle\\!\\left\\langle 1 \\right|  \\text{Tr}\\left( \\left| 0 \\right\\rangle\\!\\left\\langle 1 \\right| \\right)+\\frac{1}{2}  \\left| 1 \\right\\rangle\\!\\left\\langle 0 \\right|  \\text{Tr}\\left( \\left| 1 \\right\\rangle\\!\\left\\langle 0 \\right| \\right) +\\frac{1}{2}  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right|  \\text{Tr}\\left( \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right| \\right)\\\\\n",
    " &=  \\frac{1}{2}  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right| + \\frac{1}{2}  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right| \\\\\n",
    " &=  \\frac{1}{2} I\n",
    "\\end{align*}\n",
    "$$\n",
    "\n",
    "where the third equality follows from the linearity of the partial trace, the fifth by $\\text{Tr}_B\\left( \\rho\\right)= \\rho_1. \\text{Tr}\\left( \\rho_2\\right)$, and the sixth by the cyclic property of the trace and since $ \\left|0\\right\\rangle $ and $ \\left|1\\right\\rangle $ are orthogonal. Thus, the reduced state on qubit 1 for the Bell state is maximally mixed ! In other words, it is a completely random state about which we have zero information. In a similar fashion, one can show that $  \\text{Tr}_A\\left( \\left| \\Phi^+ \\right\\rangle\\!\\left\\langle \\Phi^+ \\right| \\right) = I/2$.\n",
    "\n",
    "And here we arrive at one of the most confounding aspects of quantum mechanics: As in the case of the Bell state, it is possible for us to know absolutely nothing about the states of qubits 1 and 2 individually (e.g. they have reduced states I/2), but when we bring both qubits together, we know everything about their joint state (e.g. $ \\left|\\Phi^+\\right\\rangle $ is a pure state, i.e. there is no uncertainty). This is yet another striking example of a quantum phenomenon which does not occur in the classical world."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "### Using partial trace to detect entanglement\n",
    "\n",
    "Recall we said that an arbitrary bipartite _pure_ state $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C}^d \\otimes  \\mathbb{C}^d$ can be written in terms of its Schmidt decomposition\n",
    "\n",
    "$$\n",
    " \\left|\\psi\\right\\rangle = \\sum_{i=1} \\alpha_i \\left|a_i\\right\\rangle  \\left|b_i\\right\\rangle\n",
    "$$\n",
    "\n",
    "where $\\alpha_i\\geq0$ and $ \\left\\{ \\left|a_i\\right\\rangle \\right\\} $ and $ \\left\\{ \\left|b_i\\right\\rangle \\right\\} $ are orthonormal sets. We also said that $ \\left|\\psi\\right\\rangle $ is entangled if and only if its Schmidt rank (i.e. number of non-zero Schmidt coefficients $ \\alpha_i$ ) is at least two. However, we did not discuss how to actually _find_ the Schmidt decomposition of $ \\left|\\psi\\right\\rangle $, i.e. we have not specified a procedure for computing the Schmidt rank of $ \\left|\\psi\\right\\rangle $. The partial trace allows us to solve this problem.\n",
    "\n",
    "For determining whether a bipartite pure state |ψi is entangled one needs to compute $ \\rho_A= \\text{Tr}_B\\left( \\left| \\psi \\right\\rangle\\!\\left\\langle \\psi \\right| \\right) $, and check if $ \\text{rank} \\left( \\rho_A\\right)  > 1$. If so, $ \\left|\\psi\\right\\rangle $ is entangled; otherwise, it is a product state. Finally, observe that this trick only works for pure states $ \\left|\\psi\\right\\rangle $ — indeed, for mixed bipartite $ \\rho_{AB} $ , detecting entanglement is NP-hard, so such a simple criterion for entanglement is highly unlikely to exist!\n",
    "\n",
    "### How the postulates of quantum mechanics apply to density operators\n",
    "\n",
    "In previous lectures, we introduced the postulates of quantum mechanics in the context of pure states $ \\left|\\psi\\right\\rangle $. All four postulates extend naturally to the setting of mixed quantum states. For example, for Postulate 3 on composite quantum systems, given density operators $ \\rho $ and $\\sigma$, we have that $ \\rho  \\otimes \\sigma$ is also a valid density operator. This follows from the facts that if $A$ and $B$ are positive semi-definite, then so is $A \\otimes B$, and that $ \\text{Tr}\\left(A  \\otimes B \\right)= \\text{Tr}\\left(A\\right) \\text{Tr}\\left(B\\right)$. For now, we will avoid revisiting the postulates in the mixed state setting, and rather approach the topic once the need arises in specific applications of future lectures."
   ],
   "metadata": {
    "collapsed": false
   }
  },
  {
   "cell_type": "markdown",
   "source": [
    "#### Send it after class 4\n",
    "\n",
    "* Show that for any $ \\rho =  \\rho_1 \\otimes  \\rho_2$, $ \\text{Tr}_A\\left( \\rho \\right)= \\text{Tr}\\left( \\rho_1\\right). \\rho_2$\n",
    "* What is $ \\text{Tr}_B\\left(\\frac{1}{2}  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right|  \\otimes  \\left| 0 \\right\\rangle\\!\\left\\langle 0 \\right| + \\frac{1}{2}  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right|  \\otimes  \\left| 1 \\right\\rangle\\!\\left\\langle 1 \\right|\\right) $ ?\n",
    "* Show that $ \\text{Tr}_A\\left( \\left| \\Phi^+ \\right\\rangle\\!\\left\\langle \\Phi^+ \\right| \\right)=I/2 $\n",
    "* Prove that the Schmidt rank of $ \\left|\\psi\\right\\rangle  \\in  \\mathbb{C}^d \\otimes  \\mathbb{C}^d$ equals the rank of $ \\rho_A= \\mathbb{C}  \\text{Tr}_B\\left( \\left| \\psi \\right\\rangle\\!\\left\\langle \\psi \\right| \\right) $. You should use the fact that in the definition of the partial trace, the standard basis $ \\left\\{ \\left|i\\right\\rangle \\right\\} $ on $B$ can be replaced by an arbitrary orthonormal basis, $ \\left\\{ \\left|\\psi_i\\right\\rangle \\right\\} $, on $B$. (Hint:Choose $ \\left\\{ \\left|\\psi_i\\right\\rangle \\right\\} $ as the Schmidt basis for $ \\left|\\psi\\right\\rangle $ on system $B$.)"
   ],
   "metadata": {
    "collapsed": false
   }
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}